import{r as s,j as c,m as N,a as l,y as C}from"./app-ba0260c4.js";import D from"./DiagnoseItem-590db6ad.js";const $=({dataGejala:p,search:S,onClose:v})=>{const[o,u]=s.useState(S||""),[n,g]=s.useState([]),[i,h]=s.useState(0),[f,m]=s.useState(new Set),[r,x]=s.useState(!1),d=s.useRef(null);s.useEffect(()=>{d.current&&d.current.focus()},[]),s.useEffect(()=>{h(0)},[o]);const t=s.useMemo(()=>p.filter(e=>e.Gejala.toLowerCase().includes(o.toLowerCase())),[p,o]),w=e=>{g([...n,e]),m(new Set([...f,e.kodeGejala])),u(""),d.current.focus()},b=e=>{const a=n.filter(G=>G.kodeGejala!==e.kodeGejala);g(a);const j=new Set(f);j.delete(e.kodeGejala),m(j)},y=e=>{if(e.key==="Backspace"&&e.target.value===""&&n.length>0){const a=n[n.length-1];b(a)}else e.key==="ArrowDown"&&(t==null?void 0:t.length)>0?(e.preventDefault(),h(a=>a<t.length-1?a+1:a)):e.key==="ArrowUp"&&t.length>0?(e.preventDefault(),h(a=>a>0?a-1:0)):e.key==="Enter"&&i>=0&&i<t.length&&w(t[i])},k=()=>{x(!0);const e={gejala:n.map(a=>a.kodeGejala)};C.post("/diagnose",e,{onFinish:()=>x(!1)})};return c(N.div,{className:"fixed inset-0 z-50 bg-slate-50 overflow-y-auto",initial:{clipPath:"circle(0% at 100% 0%)"},animate:{clipPath:"circle(150% at 50% 50%)"},exit:{clipPath:"circle(0% at 100% 0%)"},transition:{duration:.5,ease:"easeInOut"},children:[l("button",{className:"absolute top-4 right-4 btn-circle text-secondary hover:bg-[#407067] text-xl font-bold z-50",onClick:v,"aria-label":"Close",children:"âœ•"}),l("div",{id:"search",className:"w-full px-5 lg:px-[72px] min-h-screen bg-primary",children:c("div",{className:"flex flex-col py-20",children:[c("div",{className:"w-full max-w-[100%] relative",children:[c("div",{className:"w-full px-4 py-2 border rounded-lg flex flex-wrap items-center bg-white min-h-[3rem]",children:[n.map((e,a)=>l(D,{text:e.Gejala,onClick:()=>b(e)},`${e.kodeGejala}-${a}`)),l("input",{ref:d,type:"text",className:`grow input border-none focus:outline-none focus:ring-0 focus:shadow-none ${r?"disabled:bg-gray-50":""}`,placeholder:"Cari Gejala pada Padi...",value:o,onChange:e=>u(e.target.value),onKeyDown:y,disabled:r}),l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",className:"h-4 w-4 opacity-70",children:l("path",{fillRule:"evenodd",d:"M9.965 11.026a5 5 0 1 1 1.06-1.06l2.755 2.754a.75.75 0 1 1-1.06 1.06l-2.755-2.754ZM10.5 7a3.5 3.5 0 1 1-7 0 3.5 3.5 0 0 1 7 0Z",clipRule:"evenodd"})})]}),o&&t.length>0&&l("ul",{className:"suggestion-list",children:t.filter(e=>!f.has(e.kodeGejala)).map((e,a)=>l("li",{className:`p-1 ${a===i?"activeSelected":""}`,onClick:()=>w(e),children:l("a",{onClick:()=>u(e.Gejala),children:e.Gejala})},`${e.kodeGejala}-${a}`))})]}),c("div",{className:" flex justify-between",children:[l("span",{children:l("p",{className:"text-white text-opacity-30 text-xs my-2",children:l("i",{children:"* minimal 2 gejala"})})}),l("button",{className:"btn btn-secondary mt-2 disabled:bg-[#4f8c80] disabled:text-[#7daba2] disabled:cursor-not-allowed",onClick:k,disabled:n.length<2||r,children:r?c("span",{className:"flex items-center gap-2",children:[l("span",{className:"loading loading-spinner"}),l("i",{children:"Diagnosa"})]}):"Diagnosa"})]})]})})]})},P=$;export{P as default};
