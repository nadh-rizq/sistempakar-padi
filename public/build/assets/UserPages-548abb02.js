import{r as h,W as k,j as r,F as L,a,b as j,c as F,y as O}from"./app-ba0260c4.js";import w from"./Modal-2f824324.js";import{F as y,S as d}from"./FlashMixin-8e785d16.js";const M=({user:o,dataRole:m,flash:n})=>{h.useEffect(()=>{n!=null&&n.success&&y.fire({icon:"success",title:n.success}),n!=null&&n.error&&y.fire({icon:"error",title:n.error})},[n]);const[N,g]=h.useState(!1),[b,x]=h.useState(!1),l=k({name:"",email:"",password:"",kodeRole:""}),t=k({id:"",name:"",email:"",kodeRole:""}),R=e=>{t.setData({id:e.id,name:e.name,email:e.email,kodeRole:e.kodeRole}),x(!0)},[i,c]=h.useState({}),v=()=>{const e={};return l.data.name.trim()||(e.name="*username wajib diisi."),l.data.email.trim()?/\S+@\S+\.\S+/.test(l.data.email)?o.some(u=>u.email.toLowerCase()===l.data.email.toLowerCase())&&(e.email="email sudah terdaftar!"):e.email="format email tidak valid.":e.email="email wajib diisi.",l.data.password?l.data.password.length<8&&(e.password="password minimal 8 karakter."):e.password="password wajib diisi.",l.data.kodeRole.trim()||(e.kodeRole="role tidak boleh kosong."),c(e),Object.keys(e).length===0},C=()=>{const e={},s=t.data.email.trim();return t.data.name.trim()||(e.name="username wajib diisi."),s?/\S+@\S+\.\S+/.test(t.data.email)?o.some(f=>f.email===s&&f.id!==t.data.id)&&(e.email="email sudah digunakan oleh user lain."):e.email="format email tidak valid.":e.email="email wajib diisi.",t.data.kodeRole.trim()||(e.kodeRole="role tidak boleh kosong."),c(e),Object.keys(e).length===0},p=e=>{l.setData(e.target.name,e.target.value)},E=e=>{e.preventDefault(),v()&&l.post("/list-user",{onSuccess:()=>{g(!1),l.reset()},onError:s=>{d.fire({icon:"error",title:"Gagal!",text:s,confirmButtonColor:"#F47C7C",confirmButtonText:"OK"})}})},S=e=>{e.preventDefault(),C()&&t.put(`/list-user/${t.data.id}`,{onSuccess:()=>{x(!1),t.reset()},onError:s=>{d.fire({icon:"error",title:"Gagal!",text:s,confirmButtonColor:"#F47C7C",confirmButtonText:"OK"})}})},D=e=>{d.fire({title:"Yakin ingin menghapus?",text:"Data yang dihapus tidak bisa dikembalikan!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#F47C7C",cancelButtonColor:"#43766C",confirmButtonText:"Ya, Hapus!",cancelButtonText:"Batal",showLoaderOnConfirm:!0,preConfirm:()=>new Promise((s,u)=>{O.delete(`/list-user/${e}`,{onSuccess:()=>{s()},onError:()=>{u(),d.fire("Gagal!","Terjadi kesalahan saat menghapus data.","error")}})}),allowOutsideClick:()=>!d.isLoading()})};return r(L,{children:[a("div",{className:"py-2 w-full",children:r("div",{className:" min-h-[50px] bg-gray-50 rounded-md text-green flex justify-between items-center mr-2",children:[a("div",{className:"card-title mx-5",children:"Akun Pengguna"}),a("button",{className:"mx-5 btn btn-primary btn-sm",onClick:()=>{g(!0)},children:"+ Tambah Data"})]})}),r(w,{isOpen:N,title:"Tambah Akun Baru!",onSend:E,onClose:()=>{g(!1),l.reset(),c({})},processing:l.processing,children:[r("div",{className:"fieldset",children:[a("legend",{className:"fieldset-legend text-xs text-primary mb-[5px]",children:"Username"}),a("input",{type:"text",name:"name",value:l.data.name,onChange:p,className:"input input-primary border-none bg-gray-100 w-full",placeholder:"username",required:!0}),i.name&&a("p",{className:"text-error text-xs mt-1",children:i.name})]}),r("div",{className:"fieldset mt-2",children:[a("legend",{className:"fieldset-legend text-xs text-primary mb-[5px]",children:"Email"}),a("input",{type:"email",name:"email",value:l.data.email,onChange:p,className:"input input-primary border-none bg-gray-100 w-full",placeholder:"email",required:!0}),i.email&&a("p",{className:"text-error text-xs mt-1",children:i.email})]}),r("div",{className:"fieldset mt-2",children:[a("legend",{className:"fieldset-legend text-xs text-primary mb-[5px]",children:"Default Password"}),a("input",{type:"password",name:"password",value:t.data.password,onChange:p,className:"input input-primary border-none bg-gray-100 w-full",placeholder:"password",required:!0}),i.password&&a("p",{className:"text-error text-xs mt-1",children:i.password})]}),r("div",{className:"fieldset mt-2",children:[a("legend",{className:"fieldset-legend text-xs text-primary mb-[5px] mt-2",children:"Role"}),r("select",{name:"kodeRole",className:`select w-full ${l.data.kodeRole==="R0LE01"?"bg-error text-white font-bold":l.data.kodeRole==="R0LE02"?"bg-yellow-500 text-white font-bold":l.data.kodeRole==="R0LE03"?"bg-success text-white font-bold":"bg-gray-100 text-gray-300 font-semibold text-sm"}`,value:l.data.kodeRole,onChange:p,children:[a("option",{className:"bg-gray-100 hidden",children:"pilih role"}),m?m.map(e=>a("option",{className:"bg-gray-100 text-gray-500",value:e.kodeRole,children:e.role.charAt(0).toUpperCase()+e.role.slice(1)},e.kodeRole)):""]}),i.kodeRole&&a("p",{className:"text-error text-xs mt-1",children:i.kodeRole})]})]}),b&&r(w,{isOpen:b,title:"Ubah Informasi Akun!",onSend:S,onClose:()=>{x(!1),t.reset(),c({})},processing:t.processing,children:[a("input",{type:"hidden",name:"id",onChange:e=>t.setData("id",e.target.value)}),r("div",{className:"fieldset",children:[a("legend",{className:"fieldset-legend text-xs text-primary mb-[5px]",children:"Username"}),a("input",{type:"text",name:"name",value:t.data.name,onChange:e=>t.setData("name",e.target.value),className:"input input-primary border-none bg-gray-100 w-full",required:!0}),i.name&&a("p",{className:"text-error text-xs mt-1",children:i.name})]}),r("div",{className:"fieldset mt-2",children:[a("legend",{className:"fieldset-legend text-xs text-primary mb-[5px]",children:"Email"}),a("input",{type:"email",name:"email",value:t.data.email,onChange:e=>t.setData("email",e.target.value),className:"input input-primary border-none bg-gray-100 w-full",required:!0}),i.email&&a("p",{className:"text-error text-xs mt-1",children:i.email})]}),r("div",{className:"fieldset mt-2",children:[a("legend",{className:"fieldset-legend text-xs text-primary mb-[5px] mt-2",children:"Role"}),r("select",{name:"kodeRole",className:`select w-full font-bold ${t.data.kodeRole==="R0LE01"?"bg-error text-white":t.data.kodeRole==="R0LE02"?"bg-yellow-500 text-white":t.data.kodeRole==="R0LE03"?"bg-success text-white":"bg-gray-100 "}`,value:t.data.kodeRole,onChange:e=>t.setData("kodeRole",e.target.value),children:[a("option",{className:"bg-gray-100",disabled:!0,children:"Pilih Role"}),m?m.map(e=>a("option",{className:"bg-gray-100 text-black",value:e.kodeRole,children:e.role.charAt(0).toUpperCase()+e.role.slice(1)},e.kodeRole)):""]}),i.kodeRole&&a("p",{className:"text-error text-xs mt-1",children:i.kodeRole})]})]}),a("div",{className:"w-full py-2",children:a("div",{className:"h-[calc(100vh-165px)] overflow-x-auto rounded-lg  ",children:r("table",{className:"table table-pin-rows bg-gray-50",children:[a("thead",{className:"border-b-2 text-sm text-primary font-bold",children:r("tr",{children:[a("th",{children:"#"}),a("th",{children:"USERNAME"}),a("th",{children:"EMAIL"}),a("th",{children:"ROLE"}),a("th",{className:"text-center",children:"AKSI"})]})}),a("tbody",{className:"text-gray-400",children:o?o.map((e,s)=>r("tr",{children:[a("td",{children:s+1}),a("td",{children:e.name}),a("td",{children:e.email}),a("td",{children:e.kodeRole==="R0LE01"?a("div",{className:"badge badge-error font-bold text-white",children:"Admin"}):e.kodeRole==="R0LE02"?a("div",{className:"badge bg-yellow-500 font-bold text-white",children:"Expert"}):e.kodeRole==="R0LE03"?a("div",{className:"badge badge-success font-bold text-white",children:"User"}):"badge-ghost"}),a("td",{className:"text-center",children:r("div",{className:"flex items-center justify-center gap-1",children:[a("button",{className:"btn btn-xs text-primary btn-circle",onClick:()=>R(e),children:a(j,{})}),a("button",{className:"btn btn-xs text-primary btn-circle",onClick:()=>D(e.id),children:a(F,{})})]})})]},s)):a("tr",{className:"text-center",children:a("td",{colSpan:5,children:a("i",{children:"~ belum ada data ~"})})})})]})})})]})};export{M as default};
