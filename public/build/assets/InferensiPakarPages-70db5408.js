import{r as p,j as s,F as y,a as e,d as T,b as H,c as $,y as j}from"./app-996c5dc9.js";import D from"./Modal-aee7d2fa.js";import{F as E,S as v}from"./FlashMixin-8e785d16.js";const V=({dataKeputusan:b,dataOpt:w,dataGejala:k,dataKategori:G,flash:d})=>{var S,P;p.useEffect(()=>{d!=null&&d.success&&E.fire({icon:"success",title:d.success}),d!=null&&d.error&&E.fire({icon:"error",title:d.error})},[d]);const x=w.filter(a=>!b.some(l=>l.opt.id===a.id)),[A,f]=p.useState(!1),[I,N]=p.useState(!1),[C,m]=p.useState(!1),[g,h]=p.useState({opt:"",selectedGejala:[{gejala:"",kategori:""}]}),O=(a,l,t)=>{const c=[...g.selectedGejala];c[a][l]=t,h({...g,selectedGejala:c})},F=()=>{h(a=>({...a,selectedGejala:[...a.selectedGejala,{gejala:"",kategori:""}]}))},M=a=>{h(l=>({...l,selectedGejala:l.selectedGejala.filter((t,c)=>c!==a)}))},[i,u]=p.useState(null),B=a=>{var n;const l=b.filter(r=>r.opt.opt===a),t=l.map(r=>({id_inferensi:r.id,gejala:r.gejala.id,kategori:r.kategori.id})),c=(n=l[0])==null?void 0:n.opt;u({opt:c,selectedGejala:t}),N(!0)},K=()=>{u(a=>({...a,selectedGejala:[...a.selectedGejala,{id_inferensi:null,gejala:"",kategori:""}]}))},J=(a,l)=>{const t=[...i.selectedGejala];t[a].gejala=l,u({...i,selectedGejala:t})},L=(a,l)=>{const t=[...i.selectedGejala];t[a].kategori=l,u({...i,selectedGejala:t})},R=a=>{const l=[...i.selectedGejala];l.splice(a,1),u({...i,selectedGejala:l})},U=a=>{a.preventDefault(),m(!0),j.post("/save-keputusan",g,{onSuccess:()=>{m(!1),f(!1)},onError:()=>{m(!1)}})},_=a=>{a.preventDefault(),m(!0),j.post("/edit-keputusan",i,{onSuccess:()=>{m(!1),N(!1)},onError:()=>{m(!1)}})},Y=a=>{v.fire({title:"Yakin ingin menghapus?",text:"Data yang dihapus tidak bisa dikembalikan!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#F47C7C",cancelButtonColor:"#43766C",confirmButtonText:"Ya, Hapus!",cancelButtonText:"Batal",showLoaderOnConfirm:!0,preConfirm:()=>new Promise((l,t)=>{j.delete(`/list-tabKeputusan/${a}`,{onSuccess:()=>{l()},onError:()=>{t(),v.fire("Gagal!","Terjadi kesalahan saat menghapus data.","error")}})}),allowOutsideClick:()=>!v.isLoading()})};return s(y,{children:[e("div",{className:"py-2 w-full",children:s("div",{className:" min-h-[50px] bg-gray-50 rounded-md text-green flex justify-between items-center mr-2",children:[e("div",{className:"card-title mx-5",children:"Data Inferensi Pakar"}),e("button",{className:"mx-5 btn btn-primary btn-sm",onClick:()=>f(!0),children:"+ Tambah Data"})]})}),s(D,{isOpen:A,title:"Masukkan Inferensi Baru",onSend:U,onClose:()=>{f(!1),h({opt:"",selectedGejala:[{gejala:"",kategori:""}]})},processing:C,w:"max-w-5xl",children:[e("fieldset",{className:"flex flex-col fieldset rounded-box",children:e("legend",{className:"fieldset-legend text-xs text-primary mb-[5px]",children:"Jenis Organisme Pengganggu Tumbuhan (OPT)"})}),s("select",{name:"gejala",className:"select w-full bg-gray-100 text-gray-500 font-semibold",value:g.opt,onChange:a=>h({...g,opt:a.target.value}),disabled:x.length===0,children:[e("option",{className:"bg-gray-100 hidden",children:"Pilih OPT"}),x.length>0?x.map(a=>e("option",{value:a.id,className:"bg-gray-100 text-gray-500",children:a.opt},a.id)):e("option",{disabled:!0,value:"",children:"~ Seluruh OPT Telah Diklasifikasikan Pakar ~"})]}),x.length>0?s(y,{children:[e("hr",{className:"mt-4 mb-2"}),e("div",{className:"flex items-end",children:e("button",{type:"button",className:"btn btn-primary btn-sm ml-auto",onClick:F,children:"+ Gejala"})}),s("div",{className:"flex gap-4",children:[e("div",{className:"w-5/6",children:e("legend",{className:"fieldset-legend text-xs text-primary mt-2",children:"Gejala-gejala"})}),e("div",{className:"w-1/6",children:e("legend",{className:"fieldset-legend text-xs text-primary mt-2",children:"Kategori"})}),e("div",{children:e("legend",{className:"fieldset-legend text-xs text-primary mt-2"})})]}),g.selectedGejala.map((a,l)=>s("div",{className:"flex gap-4 py-1",children:[e("div",{className:"w-5/6",children:s("select",{name:"gejala",className:"select w-full bg-gray-100 text-gray-500 font-semibold",value:a.gejala,onChange:t=>O(l,"gejala",t.target.value),children:[e("option",{className:"bg-gray-100 hidden",children:"Pilih Gejala"}),k.map(t=>e("option",{value:t.id,className:"bg-gray-100 text-gray-500",children:t.gejala},t.id))]})}),e("div",{className:"w-1/6",children:s("select",{name:"kategori",className:"select w-full font-semibold bg-gray-100 text-gray-500",value:a.kategori,onChange:t=>O(l,"kategori",t.target.value),children:[e("option",{className:"bg-gray-100 hidden",children:"Pilih Kategori"}),G.map(t=>e("option",{value:t.id,className:"bg-gray-100 text-gray-500",children:t.kategori},t.id))]})}),e("div",{className:"flex items-center",children:e("button",{type:"button",className:"btn btn-xs text-white btn-circle btn-error",onClick:()=>M(l),children:e(T,{})})})]},l))]}):""]}),e(D,{isOpen:I,title:"Edit Inferensi Pakar",onSend:_,onClose:()=>N(!1),processing:C,w:"max-w-5xl",children:s("fieldset",{className:"flex flex-col fieldset rounded-box",children:[e("legend",{className:"fieldset-legend text-xs text-primary mb-[5px]",children:"Jenis Organisme Pengganggu Tumbuhan (OPT)"}),i&&s(y,{children:[e("input",{type:"text",className:"input input-primary disabled:bg-gray-100 disabled:text-gray-500 font-extrabold text-sm w-full",value:((S=w.find(a=>{var l;return a.id===((l=i.opt)==null?void 0:l.id)}))==null?void 0:S.opt)||"",disabled:!0}),e("input",{type:"hidden",name:"opt",value:(P=i.opt)==null?void 0:P.id}),e("hr",{className:"mt-4 mb-2"}),e("div",{className:"flex items-end",children:e("button",{type:"button",className:"btn btn-primary btn-sm ml-auto",onClick:K,children:"+ Gejala"})}),s("div",{className:"flex gap-4",children:[e("div",{className:"w-5/6",children:e("legend",{className:"fieldset-legend text-xs text-primary mt-2",children:"Gejala-gejala"})}),e("div",{className:"w-1/6",children:e("legend",{className:"fieldset-legend text-xs text-primary mt-2",children:"Kategori"})}),e("div",{children:e("legend",{className:"fieldset-legend text-xs text-primary mt-2"})})]}),i.selectedGejala.map((a,l)=>s("div",{className:"flex gap-4 py-1",children:[e("div",{className:"w-5/6",children:s("select",{name:"gejala",className:"select w-full bg-gray-100 text-gray-500 font-semibold",value:a.gejala,onChange:t=>J(l,t.target.value),children:[e("option",{className:"bg-gray-100 hidden",children:"Pilih Gejala"}),k.map(t=>e("option",{value:t.id,className:"bg-gray-100 text-gray-500",children:t.gejala},t.id))]})}),e("div",{className:"w-1/6",children:s("select",{name:"kategori",className:"select w-full font-semibold bg-gray-100 text-gray-500",value:a.kategori,onChange:t=>L(l,t.target.value),children:[e("option",{className:"bg-gray-100 hidden",children:"Pilih Kategori"}),G.map(t=>e("option",{value:t.id,className:"bg-gray-100 text-gray-500",children:t.kategori},t.id))]})}),e("div",{className:"flex items-center",children:e("button",{type:"button",className:"btn btn-xs text-white btn-circle btn-error",onClick:()=>{R(l)},children:e(T,{})})})]},l))]})]})}),e("div",{className:"w-full py-2",children:e("div",{className:"h-[calc(100vh-165px)] overflow-x-auto rounded-lg",children:s("table",{className:"table table-pin-rows bg-gray-50",children:[e("thead",{className:"border-b-2 text-sm text-primary font-bold",children:s("tr",{children:[e("th",{children:"#"}),e("th",{colSpan:2,children:"OPT"}),e("th",{colSpan:2,children:"GEJALA"}),e("th",{children:"KATEGORI"}),e("th",{className:"text-center",children:"AKSI"})]})}),e("tbody",{className:"text-gray-400",children:(()=>{if(!b)return null;const a=[...b].sort((n,r)=>n.opt.id-r.opt.id);if(a.length===0)return e("tr",{className:"text-center",children:e("td",{colSpan:7,children:e("i",{children:"~ belum ada data ~"})})});const l={};a.forEach(n=>{l[n.opt.opt]=(l[n.opt.opt]||0)+1});let t=null,c=1;return a.map((n,r)=>{const o=t!==n.opt.opt;return o&&(t=n.opt.opt),s("tr",{children:[o?e("td",{rowSpan:l[n.opt.opt],className:r!==0?"border-t-2 border-gray-300":"",children:c++}):null,o?e("td",{rowSpan:l[n.opt.opt],className:r!==0?"border-t-2 border-gray-300":"",children:n.opt.kodeOpt}):null,o?e("td",{rowSpan:l[n.opt.opt],className:r!==0?"border-t-2 border-gray-300":"",children:n.opt.opt}):null,e("td",{className:o&&r!==0?"border-t-2 border-gray-300":"",children:n.gejala.kodeGejala}),e("td",{className:o&&r!==0?"border-t-2 border-gray-300":"",children:n.gejala.gejala}),e("td",{className:o&&r!==0?"border-t-2 border-gray-300":"",children:n.kategori.bobot}),o?e("td",{rowSpan:l[n.opt.opt],className:r!==0?"border-t-2 border-gray-300":"",children:s("div",{className:"flex items-center justify-center gap-1",children:[e("button",{className:"btn btn-xs text-primary btn-circle",onClick:()=>B(n.opt.opt),children:e(H,{})}),e("button",{className:"btn btn-xs text-primary btn-circle",onClick:()=>Y(n.opt.id),children:e($,{})})]})}):null]},r)})})()})]})})})]})};export{V as default};
