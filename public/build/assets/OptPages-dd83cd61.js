import{r as o,W as N,j as i,F as B,a,b as F,c as E,A as M,m as y,y as G}from"./app-ba0260c4.js";import w from"./Modal-2f824324.js";import{F as v,S as c}from"./FlashMixin-8e785d16.js";import O from"./Textarea-dc41ae47.js";const U=({optPadi:d,flash:s})=>{o.useEffect(()=>{s!=null&&s.success&&v.fire({icon:"success",title:s.success}),s!=null&&s.error&&v.fire({icon:"error",title:s.error})},[s]);const[C,g]=o.useState(!1),[b,u]=o.useState(!1),[f,k]=o.useState(null),l=N({opt:"",nama_latin:"",deskripsi:"",gambar:null}),n=N({kodeOpt:"",opt:"",nama_latin:"",deskripsi:"",gambar:null}),[r,h]=o.useState({}),T=e=>{const t={};return!e.opt||e.opt.trim()===""?t.opt="*jenis OPT wajib diisi!":e.opt.length>255?t.opt="*maksimal 255 karakter!":d.some(p=>p.opt.toLowerCase()===e.opt.toLowerCase())&&(t.opt="*jenis OPT sudah ada!"),!e.nama_latin||e.nama_latin.trim()===""?t.nama_latin="*nama latin wajib diisi!":e.nama_latin.length>255&&(t.nama_latin="*maksimal 255 karakter!"),e.deskripsi&&e.deskripsi.length>255&&(t.deskripsi="*maksimal 255 karakter!"),e.gambar&&(["image/jpeg","image/jpg","image/png"].includes(e.gambar.type)?e.gambar.size>2*1024*1024&&(t.gambar="*ukuran maksimal 2MB!"):t.gambar="*format gambar harus JPG, JPEG, atau PNG!"),h(t),Object.keys(t).length===0},P=e=>{const t={};return!e.opt||e.opt.trim()===""?t.opt="*jenis OPT wajib diisi!":e.opt.length>255?t.opt="*maksimal 255 karakter!":d.some(p=>p.opt.toLowerCase()===e.opt.toLowerCase()&&p.kodeOpt!==e.kodeOpt)&&(t.opt="*jenis OPT sudah ada!"),!e.nama_latin||e.nama_latin.trim()===""?t.nama_latin="*nama latin wajib diisi!":e.nama_latin.length>255&&(t.nama_latin="*maksimal 255 karakter!"),e.deskripsi&&e.deskripsi.length>255&&(t.deskripsi="*maksimal 255 karakter!"),e.gambar&&(["image/jpeg","image/jpg","image/png"].includes(e.gambar.type)?e.gambar.size>2*1024*1024&&(t.gambar="*ukuran maksimal 2MB!"):t.gambar="*format gambar harus JPG, JPEG, atau PNG!"),h(t),Object.keys(t).length===0},x=e=>{l.setData(e.target.name,e.target.value)},j=e=>{n.setData({kodeOpt:e.kodeOpt,opt:e.opt,nama_latin:e.nama_latin,deskripsi:e.deskripsi,gambar:null}),h({}),u(!0)},_=e=>{e.preventDefault(),T(l.data)&&l.post("/list-opt",{forceFormData:!0,onSuccess:()=>{g(!1),l.reset()},onError:()=>{c.fire({icon:"error",title:"Gagal!",text:"Terjadi kesalahan, coba lagi.",confirmButtonColor:"#F47C7C",confirmButtonText:"OK"})}})},D=e=>{e.preventDefault(),P(n.data)&&n.post(`/list-opt/${n.data.kodeOpt}`,{_method:"PUT",forceFormData:!0,onSuccess:()=>{u(!1),n.reset()},onError:()=>{c.fire({icon:"error",title:"Gagal!",text:"Terjadi kesalahan, coba lagi.",confirmButtonColor:"#F47C7C",confirmButtonText:"OK"})}})},S=e=>{c.fire({title:"Yakin ingin menghapus?",text:"Data yang dihapus tidak bisa dikembalikan!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#F47C7C",cancelButtonColor:"#43766C",confirmButtonText:"Ya, Hapus!",cancelButtonText:"Batal",showLoaderOnConfirm:!0,preConfirm:()=>new Promise((t,m)=>{G.delete(`/list-opt/${e}`,{onSuccess:()=>{t()},onError:()=>{m(),c.fire("Gagal!","Terjadi kesalahan saat menghapus data.","error")}})}),allowOutsideClick:()=>!c.isLoading()})};return i(B,{children:[a("div",{className:"py-2 w-full",children:i("div",{className:" min-h-[50px] bg-gray-50 rounded-md text-green flex justify-between items-center mr-2",children:[a("div",{className:"card-title mx-5",children:"Data Organisme Pengganggu Tumbuhan (OPT)"}),a("button",{className:"mx-5 btn btn-primary btn-sm",onClick:()=>g(!0),children:"+ Tambah Data"})]})}),i(w,{isOpen:C,title:"Masukkan Jenis OPT Baru!",onSend:_,onClose:()=>g(!1),processing:l.processing,children:[i("div",{className:"fieldset",children:[a("legend",{className:"fieldset-legend text-xs text-primary mb-[5px]",children:"Jenis OPT"}),a("input",{type:"text",name:"opt",value:l.data.opt,onChange:x,className:"input input-primary border-none bg-gray-100 w-full",placeholder:"Jenis Organisme Pengganggu Tumbuhan...",required:!0}),r.opt&&a("p",{className:"text-error text-xs mt-1",children:r.opt})]}),i("div",{className:"fieldset mt-2",children:[a("legend",{className:"fieldset-legend text-xs text-primary mb-[5px]",children:"Nama Latin"}),a("input",{type:"text",name:"nama_latin",value:l.data.nama_latin,onChange:x,className:"input input-primary border-none bg-gray-100 w-full",placeholder:"Nama Latin Organisme Pengganggu Tumbuhan...",required:!0}),r.nama_latin&&a("p",{className:"text-error text-xs mt-1",children:r.nama_latin})]}),i("div",{className:"fieldset mt-2",children:[a("legend",{className:"fieldset-legend text-xs text-primary mb-[5px]",children:"Deskripsi"}),a(O,{name:"deskripsi",value:l.data.deskripsi,onChange:x,placeholder:"Informasi Singkat Organisme Pengganggu Tumbuhan..."}),r.deskripsi&&a("p",{className:"text-error text-xs mt-1",children:r.deskripsi})]}),i("div",{className:"fieldset mt-2",children:[i("legend",{className:"fieldset-legend text-xs text-primary mb-[5px]",children:["Gambar Pendukung (",a("i",{children:"ukuran file maksimal 2MB"}),")"]}),a("input",{type:"file",name:"gambar",onChange:e=>{l.setData("gambar",e.target.files[0])},className:"file-input file-input-sm w-full border-none bg-gray-100 text-gray-300 font-semibold"}),r.gambar&&a("p",{className:"text-error text-xs mt-1",children:r.gambar})]})]}),b&&i(w,{isOpen:b,title:"Ubah data OPT!",onSend:D,onClose:()=>u(!1),processing:n.processing,children:[i("div",{className:"fieldset",children:[a("legend",{className:"fieldset-legend text-xs text-primary mb-[5px]",children:"Jenis OPT"}),a("input",{type:"text",name:"opt",value:n.data.opt,onChange:e=>n.setData("opt",e.target.value),className:"input input-primary border-none bg-gray-100 w-full",required:!0}),r.opt&&a("p",{className:"text-error text-xs mt-1",children:r.opt})]}),i("div",{className:"fieldset mt-2",children:[a("legend",{className:"fieldset-legend text-xs text-primary mb-[5px]",children:"Nama Latin"}),a("input",{type:"text",name:"nama_latin",value:n.data.nama_latin,onChange:e=>n.setData("nama_latin",e.target.value),className:"input input-primary border-none bg-gray-100 w-full",required:!0}),r.nama_latin&&a("p",{className:"text-error text-xs mt-1",children:r.nama_latin})]}),i("div",{className:"fieldset mt-2",children:[a("legend",{className:"fieldset-legend text-xs text-primary mb-[5px]",children:"Deskripsi"}),a(O,{name:"deskripsi",value:n.data.deskripsi,onChange:e=>n.setData("deskripsi",e.target.value),placeholder:"Informasi Singkat Organisme Pengganggu Tumbuhan..."}),r.deskripsi&&a("p",{className:"text-error text-xs mt-1",children:r.deskripsi})]}),i("div",{className:"fieldset mt-2",children:[i("legend",{className:"fieldset-legend text-xs text-primary mb-[5px]",children:["Gambar Pendukung (",a("i",{children:"ukuran file maksimal 2MB"}),")"]}),a("input",{type:"file",name:"gambar",onChange:e=>{e.target.files.length>0?n.setData("gambar",e.target.files[0]):n.setData("gambar",null)},className:"file-input file-input-sm w-full border-none bg-gray-100 text-gray-300 font-semibold"}),r.gambar&&a("p",{className:"text-error text-xs mt-1",children:r.gambar})]})]}),a("div",{className:"w-full py-2",children:i("div",{className:"h-[calc(100vh-165px)] overflow-x-auto rounded-lg  ",children:[i("table",{className:"table table-pin-rows bg-gray-50",children:[a("thead",{className:"border-b-2 text-sm text-primary font-bold",children:i("tr",{children:[a("th",{children:"#"}),a("th",{children:"KODE OPT"}),a("th",{children:"JENIS OPT"}),a("th",{children:"NAMA LATIN"}),a("th",{children:"DESKRIPSI"}),a("th",{children:"GAMBAR"}),a("th",{className:"text-center",children:"AKSI"})]})}),a("tbody",{className:"text-gray-400",children:d?d.map((e,t)=>i("tr",{children:[a("td",{children:t+1}),a("td",{children:e.kodeOpt}),a("td",{children:e.opt}),a("td",{children:a("i",{children:e.nama_latin})}),a("td",{children:e.deskripsi}),a("td",{className:"text-center align-middle",children:a("div",{className:"flex items-center justify-center h-full",children:e.gambar?a("img",{src:`/show/${e.gambar}`,className:"h-10 w-10 object-cover rounded",onClick:()=>k(`/show/${e.gambar}`)}):a("i",{className:"text-xs",children:"belum ada gambar"})})}),a("td",{className:"text-center",children:i("div",{className:"flex items-center justify-center gap-1",children:[a("button",{className:"btn btn-xs text-primary btn-circle",onClick:()=>j(e),children:a(F,{})}),a("button",{className:"btn btn-xs text-primary btn-circle",onClick:()=>S(e.kodeOpt),children:a(E,{})})]})})]},t)):a("tr",{className:"text-center",children:a("td",{colSpan:5,children:a("i",{children:"~ belum ada data ~"})})})})]}),a(M,{children:f&&a(y.div,{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:()=>k(null),initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:a(y.img,{src:f,alt:"Preview",className:"max-h-[90vh] max-w-[90vw] rounded-lg shadow-lg",initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},transition:{duration:.3},onClick:e=>e.stopPropagation()})})})]})})]})};export{U as default};
